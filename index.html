<!-- ...（前略：HTMLとCSS部分はそのままです）... -->

  <!-- ▼▼ カルーセル：header直下 ▼▼ -->
  <div class="carousel-wrap">
    <div class="carousel-view" id="carouselView">
      <div class="carousel-track" id="carouselTrack">
        <!-- JSで動的に画像5枚表示 -->
      </div>
    </div>
  </div>
  <!-- ▲▲ カルーセルここまで ▲▲ -->

<!-- ...（main以下もそのままです）... -->

<script>
  // ...（drawer, toggleSection等もそのまま）...

  // ===== カルーセル画像リスト =====
  const carouselImages = [
    { src: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=800", alt: "sample1" },
    { src: "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?w=800", alt: "sample2" },
    { src: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?w=800", alt: "sample3" },
    { src: "https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?w=800", alt: "sample4" },
    { src: "https://images.unsplash.com/photo-1465101178521-c1a9136a3fd0?w=800", alt: "sample5" }
  ];

  const carouselTrack = document.getElementById('carouselTrack');
  const carouselView = document.getElementById('carouselView');
  let centerIdx = 2; // 3枚目中央から開始
  let selectedIdx = null;
  let autoSlide = true;
  let slideTimer = null;

  function renderCarousel() {
    carouselTrack.innerHTML = '';
    const total = carouselImages.length;
    for (let i = -2; i <= 2; i++) {
      const imgIdx = (centerIdx + i + total) % total;
      const img = document.createElement('img');
      img.src = carouselImages[imgIdx].src;
      img.alt = carouselImages[imgIdx].alt;
      img.className = "carousel-thumb";
      if (i === -2 || i === 2) img.style.opacity = "0.55";
      if (i === -1 || i === 1) img.classList.add('near');
      if (i === 0) img.classList.add('center');
      if (selectedIdx === imgIdx) img.classList.add('selected');
      img.addEventListener('click', (e) => {
        e.stopPropagation();
        selectedIdx = imgIdx;
        autoSlide = false;
        renderCarousel();
      });
      carouselTrack.appendChild(img);
    }
  }

  function startAutoSlide() {
    if (slideTimer) clearInterval(slideTimer);
    slideTimer = setInterval(() => {
      if (autoSlide && selectedIdx === null) {
        centerIdx = (centerIdx + 1) % carouselImages.length;
        renderCarousel();
      }
    }, 10000);
  }

  document.addEventListener('click', (e) => {
    if (!carouselTrack.contains(e.target)) {
      selectedIdx = null;
      autoSlide = true;
      renderCarousel();
    }
  });

  // ===== マウスポインター位置による左右スライド =====
  carouselView.addEventListener('mousemove', (e) => {
    if (selectedIdx !== null) return; // 選択中は動かさない
    const rect = carouselView.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const width = rect.width;
    // 右半分
    if (x > width / 2) {
      centerIdx = (centerIdx + 1) % carouselImages.length;
      renderCarousel();
      autoSlide = false;
    }
    // 左半分
    else if (x < width / 2) {
      centerIdx = (centerIdx - 1 + carouselImages.length) % carouselImages.length;
      renderCarousel();
      autoSlide = false;
    }
    // ワンショットで動かすため、マウス移動で何度も動かないように1度だけでOK
    carouselView.onmousemove = null;
    setTimeout(() => {
      carouselView.onmousemove = arguments.callee;
    }, 500); // 0.5秒ブロック（連続スクロール抑止）
  });

  window.addEventListener('resize', renderCarousel);

  renderCarousel();
  startAutoSlide();
</script>
